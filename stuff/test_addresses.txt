https://regex101.com/r/Vo0bCT/1

^\[((?P<address1>.*?)%(?P<zone1>.*)?\]:?(?P<port1>\d{1,5})?)$|\[((?P<address2>.*?)\]:?(?P<port2>\d{1,5})?)$|^(?P<address3>.*?)%(?P<zone3>.*)?$|^(?P<address4>([0-9a-fA-F]{0,4}:){2,7}[0-9a-fA-F]{0,4}?)$

// -----------------------------------
// URI IPv6
// [IPv6]:Port, [IPv6:IPv4]:Port,
// [IPv6%ZoneID]:Port, [IPv6:IPv4%ZoneID]:Port
^\[(?P<ipv6a>(([0-9a-fA-F]{0,4}:){2,8}[0-9a-fA-F]{0,4}?)((?P<ipv4addr1>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}))?)?(%(?P<zone1>.*))?\]:?(?P<port1>\d{1,5})?$
// -----------------------------------
// IPv6
// IPv6, IPv6%ZoneID,
// IPv6:IPv4, IPv6:IPv4%ZoneID
`^(?P<ipv6a>(([0-9a-fA-F]{0,4}:){2,8}[0-9a-fA-F]{0,4}?)((?P<ipv4addr1>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}))?)?(%(?P<zone1>.*))?$`gm

// -----------------------------------
// IPv4
// IPv4, IPv4:Port
`^(?P<ipv4addr1>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}):?(?P<port1>\d{1,5})?$`
// -----------------------------------




(^((?P<proto1>(http|https))(:\/\/))?((?P<subdomain1>www)\.)?\[(?P<addr1ipv6>(([0-9a-fA-F]{0,4}:){2,8}[0-9a-fA-F]{0,4}?)((?P<addr1ipv4>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}))?)?(%(?P<zone1>.*))?\]:?(?P<port1>\d{1,5})?$)|(^((?P<proto2>(http|https))(:\/\/))?((?P<subdomain2>www)\.)?(?P<addr2ipv6>(([0-9a-fA-F]{0,4}:){2,8}[0-9a-fA-F]{0,4}?)((?P<addr2ipv4>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}))?)?(%(?P<zone2>.*))?$)|(^((?P<proto3>(http|https))(:\/\/))?((?P<subdomain3>www)\.)?(?P<addr3ipv4>(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3,3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]){1,3}):?(?P<port3>\d{1,5})?$)|(^((?P<proto4>(http|https))(:\/\/))?((?P<subdomain4>www)\.)?(?P<fqdn4>(([a-zA-Zа-яА-Я0-9_-]{1,61}\.)*(?P<ext>[A-Za-zА-Яа-я]{2,}))):?(?P<port4>\d{1,5})?$)


^((?P<proto>(http|https))(:\/\/))?((?P<subdomain>www)\.)?(?P<addr4>(([a-zA-Zа-яА-Я0-9_-]{1,61}\.)*[A-Za-zА-Яа-я]{2,})):?(?P<port4>\d{1,5})?



Zone
(%(?P<zone1>.*))?



// Good examples:

// FQDN
localhost
smtp.test-mail.ru
проверка.рф

//FQDN + Port
localhost:587
smtp.test-mail.ru:587
проверка.рф:567

// IPv4
127.0.0.1
192.168.0.1
10.0.0.1
255.255.255.255

// IPv4 + Port
127.0.0.1:587
255.255.255.255:1
255.255.255.255:22
255.255.255.255:333
255.255.255.255:4444
255.255.255.255:55555

// IPv6 (normal, without port)
2001:0db8:0001:0000:0000:0ab9:C0A8:0102
2001:0DB8:0000:CD30:0000:0000:0000:0000
2001:0db8:85a3:0000:0000:8a2e:0370:7334
2001:db8:3333:4444:5555:6666:7777:8888
2001:db8:3333:4444:CCCC:DDDD:EEEE:FFFF
2001:0000:4136:e378:8000:63bf:3fff:fdd2
FF02:0:0:0:0:1:FF00:0000
FF02:0:0:0:0:1:FFFF:FFFF
FF01:0:0:0:0:0:0:101
2001:4:112:cd:65a:753:0:a1
59fb:0:0:0:0:1005:cc57:6571
FF01:0:0:0:0:0:0:2
2001:DB8:0:0:8:800:200C:417A
0:0:0:0:0:0:0:1 								 // Loopback. The IPv4 equivalent is 127.0.0.1
0:0:0:0:0:0:0:0
//----------
2001:db8:1::ab9:C0A8:102
2001:DB8::8:800:200C:417A
2001:0DB8::CD30:0:0:0:0
2001:db8::1234:5678
FF02:0:0:0:0:0:0:2
fdf8:f53b:82e4::53
fe80::200:5aee:feaa:20a2
2000::
2001:5::
2001:db8::
2001:0000::
2001:0DB8:0:CD30::
2001:db8:a0b:12f0::1
2001:0002:6c::430
fe08::7:8
fe80::200:5aee:feaa:20a2
fdf8:f53b:82e4::53
2001:10:240:ab::a
2002:cb0a:3cdd:1::1
2001:db8:8:4::2
FF01::101
::FFFF:0:0
::1234:5678
::
::1 				 							// Loopback. The IPv4 equivalent is 127.0.0.1
1:2:3:4:5:6:7:8
1::3:4:5:6:7:8
1::4:5:6:7:8
1::5:6:7:8
1::6:7:8
1::7:8
1::8
1:2::4:5:6:7:8
1:2::5:6:7:8
1:2::6:7:8
1:2::7:8
1:2::8
1:2:3::5:6:7:8
1:2:3::6:7:8
1:2:3::7:8
1:2:3::8
1:2:3:4::6:7:8
1:2:3:4::7:8
1:2:3:4::8
1:2:3:4:5::7:8
1:2:3:4:5::8
1:2:3:4:5:6::8


// IPv6 (normal. with port)
[2001:0db8:0001:0000:0000:0ab9:C0A8:0102]:587
[2001:0db8:85a3:0000:0000:8a2e:0370:7334]:587
[2001:db8:1::ab9:C0A8:102]:587
[2001:db8:1::ab9:C0A8:102]:587


// IPv6 (dual IPv6+IPv4, without port)
2001:db8:3333:4444:5555:6666:1.2.3.4
2001:db8:3:4::192.0.2.33
64:ff9b::192.0.2.33
2001:db8::123.123.123.123
::11.22.33.44
::192.168.0.1
::13.1.68.3
::255.255.255.255
::ffff:0.0.0.0
::ffff:192.0.2.47
::ffff:255.255.255.255
::ffff:10.0.0.3
::FFFF:129.144.52.38
::1234:5678:91.123.4.56
::1234:5678:1.2.3.4
2001:db8::1234:5678:5.6.7.8
2001:db8:122:344::192.0.2.33
0:0:0:0:0:0:13.1.68.3
0:0:0:0:0:FFFF:129.144.52.3


// IPv6 (dual ipv6+ipv4, with port)
[2001:db8:3333:4444:5555:6666:1.2.3.4]:587
[::11.22.33.44]:587
[2001:db8::123.123.123.123]:587
[::1234:5678:91.123.4.56]:587
[::1234:5678:1.2.3.4]:587
[2001:db8::1234:5678:5.6.7.8]:587
[2001:db8:1::ab9:C0A8:102]:587
2001:0db8:85a3:0000:0000:8a2e:0370:7334
::ffff:192.168.1.2
2b5b:1e49::fffd:833e:dfee:13a4

// link-local IPv6 addresses with zone index
[2560:d0c2:9d26:eb77:f3d5:8ca3:2069:7783%en0]:567
2560:d0c2:9d26:eb77:f3d5:8ca3:2069:7783%en0
2560:d0c2:9d26:eb77::2069:7783:192.168.0.1%en0
fe80::a%en1
[fe80::a%en1]:2512
fe80::a%ee1
fe80::7:8%eth0
fe80::7:8%1


# Invalid IPv6
56FE::2159:5BBC::6594
2001:db8:a0b:12f0::::0:1
fe80:2030:31:24
::8
:::
:1
:
::2:3:4:5:6:7:8
2001:0000:4136:e378:
8000:63bf:3fff:fdd2














[2560:d0c2:9d26:eb77:f3d5:8ca3:2069:7783%en0]:567
[2001:0db8:85a3:0000:0000:8a2e:0370:7334]:587
[2001:0db8:85a3::8a2e:0370:7334:192.168.0.1]:587
[2560:d0c2:9d26:eb77::2069:7783:192.168.0.1%en0]:22222
2001:db8:3333:4444:5555:6666:1.2.3.4
1:2:3:4:5:6:7:8
1::3:4:5:6:7:8
1::4:5:6:7:8
1::5:6:7:8
1::6:7:8
1::7:8
1::8
1:2::4:5:6:7:8
1:2::5:6:7:8
1:2::6:7:8
1:2::7:8
1:2::8
1:2:3::5:6:7:8
1:2:3::6:7:8
1:2:3::7:8
1:2:3::8
1:2:3:4::6:7:8
1:2:3:4::7:8
1:2:3:4::8
1:2:3:4:5::7:8
1:2:3:4:5::8
1:2:3:4:5:6::8

1:2:3:4:5:6:7:8%en0
1::3:4:5:6:7:8%en0
1::4:5:6:7:8%en0
1::5:6:7:8%en0
1::6:7:8%en0
1::7:8%en0
1::8%en0
1:2::4:5:6:7:8%en0
1:2::5:6:7:8%en0
1:2::6:7:8%en0
1:2::7:8%en0
1:2::8%en0
1:2:3::5:6%en0:7:8
1:2:3::6:7:8%en0
1:2:3::7:8%en0
1:2:3::8%en0
1:2:3:4::6:7:8%en0
1:2:3:4::7:8%en0
1:2:3:4::8%en0
1:2:3:4:5::7:8%en0
1:2:3:4:5::8%en0
1:2:3:4:5:6::8%en0